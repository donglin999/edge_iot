# IoT数采系统监控平台 - 需求文档

## 1. 项目概述

### 1.1 项目名称
IoT数据采集系统监控平台

### 1.2 项目描述
基于Vue 3 + Element Plus的单页面应用，用于监控和管理工业IoT设备的数据采集系统。系统提供设备管理、进程监控、数据查看、配置管理和系统监控等功能。

### 1.3 技术栈
- **前端框架**: Vue 3 (Composition API)
- **UI组件库**: Element Plus
- **路由管理**: Vue Router 4 (Hash模式)
- **状态管理**: Vuex 4
- **图表库**: ECharts + vue-echarts
- **构建工具**: Vite 4
- **数据库**: InfluxDB (时序数据库)

## 2. 系统架构

### 2.1 应用架构
- **单页面应用(SPA)**: 所有功能集成在一个页面中
- **侧边栏导航**: 通过菜单切换不同功能模块
- **无页面跳转**: 使用局部刷新提升用户体验

### 2.2 目录结构
```
frontend/
├── src/
│   ├── components/         # 功能组件
│   │   ├── charts/        # 图表组件
│   │   ├── config/        # 配置管理组件
│   │   ├── data/          # 数据查看组件
│   │   ├── process/       # 进程监控组件
│   │   └── system/        # 系统监控组件
│   ├── views/             # 页面视图
│   ├── router/            # 路由配置
│   ├── store/             # 状态管理
│   ├── services/          # API服务
│   └── utils/             # 工具函数
├── public/                # 静态资源
└── tests/                 # 测试文件
```

## 3. 功能需求

### 3.1 仪表盘 (Dashboard)

#### 3.1.1 统计卡片
- **运行中进程**: 显示当前运行的进程数量
- **停止进程**: 显示已停止的进程数量  
- **活跃设备**: 显示在线设备数量
- **数据速率**: 显示实时数据采集速率(/秒)

#### 3.1.2 图表展示
- **实时数据趋势图**: 线型图显示数据变化趋势
- **进程状态分布图**: 饼图显示进程状态占比

#### 3.1.3 进程列表
- **进程信息**: 进程名称、类型、状态、CPU使用率、内存占用
- **状态标识**: 运行中(绿色) / 已停止(红色)
- **操作按钮**: 启动、停止、重启单个进程
- **批量操作**: 全部启动、全部停止、刷新

### 3.2 进程监控 (Process Monitor)

#### 3.2.1 控制面板
- **批量操作**: 启动所有进程、停止所有进程、重启所有进程
- **刷新功能**: 手动刷新进程状态

#### 3.2.2 进程统计
- **总进程数**: 显示系统中进程总数
- **运行中进程**: 显示正在运行的进程数
- **已停止进程**: 显示停止状态的进程数
- **平均CPU使用率**: 显示所有运行进程的平均CPU占用

#### 3.2.3 详细进程列表
- **进程信息**: 进程名称、类型、状态、CPU%、内存(MB)、启动时间
- **单进程操作**: 启动、停止、重启特定进程
- **状态监控**: 实时显示进程运行状态

### 3.3 数据查看 (Data Viewer)

#### 3.3.1 设备统计
- **设备总数**: 系统中配置的设备总数
- **在线设备**: 当前在线的设备数量
- **今日数据点**: 当天采集的数据点总数
- **数据库状态**: InfluxDB连接状态显示
  - 已连接 (绿色图标)
  - 连接断开 (红色图标) 
  - 连接异常 (橙色图标)

#### 3.3.2 数据筛选
- **设备选择**: 下拉框选择特定设备(PLC-001, PLC-002, PLC-003等)
- **测点多选**: 支持多选测点(温度、压力、转速、电流、电压、流量、液位、功率)
- **时间范围**: 日期时间范围选择器
- **查询/重置**: 应用筛选条件或重置筛选

#### 3.3.3 数据展示
- **实时数据趋势图**: 显示选定测点的时间序列数据
- **设备状态分布图**: 饼图显示设备在线/离线状态
- **数据表格**: 实时数据列表
  - 时间戳、设备名称、参数名称、数值、状态
  - 状态标识: 正常(绿色) / 异常(橙色)
- **数据导出**: 支持导出当前查询结果

### 3.4 配置管理 (Configuration Manager)

#### 3.4.1 配置概览
- **配置文件数量**: 系统中配置文件总数
- **活跃配置**: 当前生效的配置数量
- **最后更新**: 配置最后更新时间

#### 3.4.2 配置操作
- **新增配置**: 添加新的配置项
- **导入配置**: 从文件导入配置
- **刷新配置**: 重新加载配置信息

#### 3.4.3 设备配置
- **设备连接配置**: 管理设备连接参数
  - 设备名称、设备类型、地址、端口、连接状态
- **设备管理**: 编辑、删除设备配置
- **连接状态**: 实时显示设备连接状态

#### 3.4.4 系统配置
- **日志配置**: 日志级别(DEBUG/INFO/WARNING/ERROR)、最大日志文件数
- **备份设置**: 自动备份开关
- **监控配置**: 监控服务端口设置

### 3.5 系统监控 (System Monitor)

#### 3.5.1 系统资源监控
- **CPU使用率**: 实时显示系统CPU占用百分比
- **内存使用率**: 实时显示内存占用百分比  
- **磁盘使用率**: 显示存储空间占用情况
- **网络状态**: 显示网络连接状态

#### 3.5.2 系统操作
- **刷新状态**: 手动刷新系统状态信息
- **重启系统**: 系统重启操作
- **导出日志**: 导出系统运行日志

#### 3.5.3 系统信息
- **操作系统**: 显示OS类型和版本
- **系统版本**: 内核版本信息
- **启动时间**: 系统运行时长
- **硬件信息**: CPU型号、总内存、可用内存

#### 3.5.4 服务状态
- **系统服务**: nginx、influxdb、redis、postgres、docker等
- **服务操作**: 启动、停止单个服务
- **状态监控**: 实时显示服务运行状态

#### 3.5.5 性能图表
- **CPU使用率趋势**: 时间序列图表显示CPU使用情况
- **内存使用率趋势**: 时间序列图表显示内存使用情况

#### 3.5.6 系统日志
- **日志级别过滤**: 支持按ERROR/WARNING/INFO级别筛选
- **实时日志**: 显示系统运行日志
- **日志操作**: 刷新日志、导出日志文件

## 4. 界面设计要求

### 4.1 整体布局
- **顶部导航栏**: 显示系统标题、连接状态、当前时间
- **左侧边栏**: 功能模块导航菜单
- **主内容区**: 动态加载不同功能模块内容
- **响应式设计**: 适配不同屏幕尺寸

### 4.2 设计风格
- **色彩方案**: 以蓝色(#409EFF)为主色调
- **状态色彩**: 
  - 成功/正常: 绿色(#67c23a)
  - 警告/异常: 橙色(#e6a23c) 
  - 错误/失败: 红色(#f56c6c)
- **卡片布局**: 使用卡片组件组织信息
- **图标系统**: Element Plus图标库

### 4.3 交互设计
- **菜单切换**: 点击侧边栏菜单切换功能模块
- **状态反馈**: 操作后提供明确的成功/失败反馈
- **加载状态**: 数据加载时显示加载指示器
- **确认对话框**: 危险操作前显示确认对话框

## 5. 数据接口需求

### 5.1 数据库状态接口
```
GET /api/database/status
Response: {
  "status": "connected|disconnected|error",
  "message": "连接状态描述",
  "timestamp": "2024-01-15T14:30:00Z"
}
```

### 5.2 设备数据接口
```
GET /api/devices
GET /api/devices/{deviceId}/data
POST /api/devices/{deviceId}/control
```

### 5.3 进程管理接口
```
GET /api/processes
POST /api/processes/{processId}/start
POST /api/processes/{processId}/stop
POST /api/processes/{processId}/restart
```

### 5.4 系统监控接口
```
GET /api/system/stats
GET /api/system/services
GET /api/system/logs
```

### 5.5 配置管理接口
```
GET /api/config
POST /api/config
PUT /api/config/{configId}
DELETE /api/config/{configId}
```

## 6. 非功能性需求

### 6.1 性能要求
- **页面加载时间**: 首次加载 < 3秒
- **数据刷新**: 实时数据更新间隔 ≤ 5秒
- **响应时间**: 用户操作响应 < 1秒

### 6.2 可用性要求
- **浏览器兼容**: 支持Chrome、Firefox、Safari、Edge最新版本
- **分辨率支持**: 最小支持1366x768分辨率
- **错误处理**: 提供友好的错误提示信息

### 6.3 安全要求
- **数据传输**: 支持HTTPS加密传输
- **输入验证**: 前端表单数据验证
- **错误信息**: 避免泄露敏感系统信息

### 6.4 维护性要求
- **代码规范**: 遵循Vue 3和ES6+编码规范
- **组件复用**: 模块化设计，组件可复用
- **文档完整**: 提供完整的开发文档

## 7. 部署要求

### 7.1 开发环境
- **Node.js**: >=16.0.0
- **包管理器**: npm或yarn
- **开发服务器**: Vite dev server

### 7.2 生产环境
- **Web服务器**: Nginx或Apache
- **静态资源**: 支持gzip压缩
- **CDN**: 可选配置CDN加速

### 7.3 构建配置
- **代码分割**: 按路由和第三方库分割
- **资源优化**: 图片压缩、CSS/JS压缩
- **兼容性**: 支持ES5语法转换

## 8. 测试要求

### 8.1 单元测试
- **组件测试**: 使用Vue Test Utils
- **工具函数测试**: 使用Jest或Vitest
- **覆盖率要求**: 代码覆盖率 > 80%

### 8.2 集成测试
- **API集成测试**: 测试前后端接口交互
- **状态管理测试**: 测试Vuex状态流转

### 8.3 端到端测试
- **用户流程测试**: 使用Playwright
- **浏览器兼容性测试**: 跨浏览器测试

## 9. 项目时间规划

### 9.1 开发阶段
- **第1周**: 项目初始化、基础框架搭建
- **第2周**: 仪表盘和进程监控模块
- **第3周**: 数据查看和配置管理模块  
- **第4周**: 系统监控模块和整体联调
- **第5周**: 测试、优化和部署

### 9.2 里程碑
- **Alpha版本**: 基础功能完成
- **Beta版本**: 全功能测试版本
- **Release版本**: 生产就绪版本

## 10. 风险评估

### 10.1 技术风险
- **第三方依赖**: Element Plus版本兼容性
- **浏览器兼容**: 新特性浏览器支持度
- **性能问题**: 大量数据渲染性能

### 10.2 进度风险
- **需求变更**: 功能需求可能调整
- **技术难点**: 实时数据更新实现复杂度
- **测试时间**: 充分测试需要额外时间

### 10.3 缓解措施
- **技术预研**: 提前验证关键技术点
- **版本控制**: 采用Git进行版本管理
- **持续集成**: 配置自动化测试和部署